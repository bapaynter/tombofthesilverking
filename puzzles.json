{
  "game_meta": {
    "title": "The Tomb of the Silver King",
    "theme": "High Fantasy Dungeon Crawler",
    "core_mechanic": "Parser-based interaction (Look, Take, Use, Push, Pull)",
    "progression": "Linear 10-stage gauntlet"
  },
  "levels": [
    {
      "id": 1,
      "name": "The Vines of Entry",
      "difficulty_score": 1,
      "setting_description": "You stand before the heavy stone entrance of the Silver King's tomb. The air is humid. A massive iron gate bars the way, but the bars are rusted. Thick, dry thorn vines completely cover the lever mechanism to the right of the gate.",
      "interactables": [
        {
          "target": "ground",
          "description": "Loose gravel and a few discarded tools from grave robbers past.",
          "interactions": [
            "`look ground`: You see the gravel and the partially buried flint and steel.",
            "`search ground`: You find nothing else of use."
          ]
        },
        {
          "target": "vines",
          "description": "They are dry and brittle, looking highly flammable. They are too thick to cut.",
          "states": [
            {
              "state": "intact",
              "interactions": [
                "`look vines`: They are a dense, thorny mass covering the lever.",
                "`pull vines` or `cut vines`: The thorns pierce your hands. It's impossible.",
                "`use flint_and_steel on vines`: You strike a spark. The vines catch fire and burn away to ash in moments. The lever is now exposed. (State changes to 'burnt')"
              ]
            },
            {
              "state": "burnt",
              "interactions": [
                "`look vines`: A pile of ash and a few smoldering tendrils."
              ]
            }
          ]
        },
        {
          "target": "gate",
          "description": "Heavy iron. It won't budge without the mechanism.",
          "states": [
            {
              "state": "closed",
              "interactions": [
                "`look gate`: It is solid and rusted shut.",
                "`open gate` or `push gate`: It doesn't move an inch."
              ]
            },
            {
              "state": "open",
              "interactions": [
                "`look gate`: The gate stands open, revealing the dark passage beyond."
              ]
            }
          ]
        },
        {
          "target": "lever",
          "description": "A rusty iron lever, now exposed after the vines burned.",
          "states": [
            {
              "state": "exposed",
              "interactions": [
                "`look lever`: A simple pull lever connected to the gate mechanism.",
                "`pull lever`: With a grinding of gears, the heavy iron gate rises. (Triggers Automatic Event: Gate Opens)"
              ]
            },
            {
              "state": "pulled",
              "interactions": [
                "`look lever`: The lever is in the down position."
              ]
            }
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "flint_and_steel",
          "name": "Flint and Steel",
          "location_description": "Lying half-buried in the gravel near your feet.",
          "states": [
            {
              "state": "on ground",
              "interactions": [
                "`look flint and steel`: A simple fire-starting kit.",
                "`take flint and steel`: You pick up the flint and steel."
              ]
            },
            {
              "state": "in inventory",
              "interactions": [
                "`look flint and steel`: A simple fire-starting kit.",
                "`use flint and steel`: You must specify a target (e.g., 'use flint and steel on vines').",
                "`use flint and steel on vines`: (See vine interaction). After successful use, the item remains in inventory but has no further use."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Clear the vines to pull the lever.",
        "solution_steps": [
          "Player must 'take flint and steel'.",
          "Player must 'use flint and steel' on 'vines'.",
          "Vines burn away. Player must 'pull lever'."
        ],
        "failure_response": "You cannot reach the lever through the sharp thorns."
      },
      "automatic_events": [
        {
          "trigger": "Player pulls the lever.",
          "action": "The gate groans open. The 'gate' object state changes to 'open'. The 'lever' object state changes to 'pulled'."
        }
      ],
      "exit_condition": "The gate groans open."
    },
    {
      "id": 2,
      "name": "The Hall of Statues",
      "difficulty_score": 2,
      "setting_description": "A long hallway lined with four statues of knights. Their stone eyes seem to follow you. At the end of the hall is a door with a circular indentation. The second statue on the left is holding something loosely in its hand.",
      "interactables": [
        {
          "target": "statues",
          "description": "Four knights. Three grip their stone swords tightly. The second one on the left has an open palm.",
          "states": [
            {
              "state": "medallion present",
              "interactions": [
                "`look statues`: Four imposing stone knights. The second on the left holds a stone medallion.",
                "`look at second statue`: This statue's open palm cradles a circular stone medallion.",
                "`take medallion`: You carefully lift the stone medallion from the statue's palm. (State changes to 'empty')"
              ]
            },
            {
              "state": "empty",
              "interactions": [
                "`look statues`: Four imposing stone knights. The second on the left has an empty, open palm."
              ]
            }
          ]
        },
        {
          "target": "door",
          "description": "A heavy stone door. It has a round recess in the center, about the size of a medallion.",
          "states": [
            {
              "state": "locked",
              "interactions": [
                "`look door`: A solid stone slab with a circular indentation.",
                "`open door`: It won't budge. There's no handle.",
                "`use stone_medallion on door`: The medallion fits perfectly into the recess. It clicks and begins to glow softly. (Triggers Automatic Event: Door Opens)"
              ]
            },
            {
              "state": "open",
              "interactions": [
                "`look door`: The door has slid up into the ceiling, revealing the next chamber."
              ]
            }
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "stone_medallion",
          "name": "Stone Medallion",
          "location_description": "Resting in the open palm of the second statue.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look medallion`: A circular piece of stone with an intricate crest carved on it.",
                "`use medallion`: You must specify a target (e.g., 'use medallion on door')."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Open the door.",
        "solution_steps": [
          "Player must 'look at statue' (specifically the second one).",
          "Player must 'take medallion'.",
          "Player must 'use medallion' on 'door'."
        ],
        "failure_response": "The door has no handle, only the circular indentation."
      },
      "automatic_events": [
        {
          "trigger": "Player uses the Stone Medallion on the door.",
          "action": "The door slides upward with a rumble of stone. The 'door' object state changes to 'open'."
        }
      ],
      "exit_condition": "The medallion fits perfectly. The door slides upward."
    },
    {
      "id": 3,
      "name": "The Weight of Greed",
      "difficulty_score": 3,
      "setting_description": "A narrow stone chamber with a smooth, polished floor. In the center stands a pressure pedestal holding a Golden Chalice. The exit door is currently closed. A magically inscribed warning on the lintel reads: 'The prize opens the way, but greed bars the path.'",
      "interactables": [
        {
          "target": "pedestal",
          "description": "A stone plinth. Taking the item from it triggers the door mechanism. Placing the chalice back upon closes the door again.",
          "states": [
            {
              "state": "occupied",
              "interactions": [
                "`look pedestal`: The Golden Chalice rests upon it.",
                "`take chalice`: As you lift the chalice, a hidden mechanism clicks. The door at the end of the room slides open. (Triggers Automatic Event A: Door Opens). The pedestal state becomes 'empty'."
              ]
            },
            {
              "state": "empty",
              "interactions": [
                "`look pedestal`: An empty stone plinth.",
                "`put chalice on pedestal` or `drop chalice on pedestal`: You place the chalice back. The door immediately slams shut. (Triggers Automatic Event B: Door Closes). The pedestal state becomes 'occupied'."
              ]
            }
          ]
        },
        {
          "target": "door",
          "description": "A heavy stone slab. It is currently shut tight. There is no handle.",
          "states": [
            {
              "state": "closed",
              "interactions": ["`look door`: A solid, featureless stone slab."]
            },
            {
              "state": "open",
              "interactions": [
                "`look door`: The doorway is open, but a magical field shimmers across it.",
                "`go north` or `enter door` (while holding chalice): As you step towards the door with the chalice, the field flashes red and the door slams shut with tremendous force! (Triggers Automatic Event B: Door Closes).",
                "`go north` or `enter door` (not holding chalice): You pass through the doorway unimpeded. (Triggers Exit Condition)."
              ]
            }
          ]
        },
        {
          "target": "floor",
          "description": "The stone floor is exceptionally smooth and polished, likely to reduce friction.",
          "interactions": [
            "`look floor`: It's slick and polished.",
            "`drop chalice`: You set the Golden Chalice down on the smooth floor. It slides a few inches."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "golden_chalice",
          "name": "Golden Chalice",
          "location_description": "Sitting temptingly on the pedestal.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look chalice`: A heavy, ornate cup made of solid gold.",
                "`drop chalice`: You place the chalice on the floor. (This is a crucial step for the solution)."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Get the Chalice and yourself through the door.",
        "solution_steps": [
          "1. Player must 'take chalice'. The door immediately slides open.",
          "2. If the player attempts to 'go north' or 'enter door' while holding the chalice, the door slams shut. The description notes: 'As you approach with the gold, the door senses your greed and slams shut.'",
          "3. If the player steps back, the door re-opens.",
          "4. Solution: The player must drop the chalice before approaching the door.",
          "5. Once the chalice is through, the player is no longer holding it. They can now walk through the open door."
        ],
        "failure_response": "The door slams shut in your face with a thunderous boom. You must back away to reset it."
      },
      "automatic_events": [
        {
          "event_id": "A",
          "trigger": "Player takes the Golden Chalice from the pedestal.",
          "action": "The door slides open. The 'door' object state changes to 'open'."
        },
        {
          "event_id": "B",
          "trigger": "1) Player places the chalice back on the pedestal. OR 2) Player attempts to pass through the open door while holding the chalice.",
          "action": "The door slams shut. The 'door' object state changes to 'closed'. The pedestal state changes to 'occupied' if triggered by placing the chalice."
        },
        {
          "event_id": "C",
          "trigger": "Player moves away from the door (e.g., 'go south') after it has slammed shut due to greed.",
          "action": "The door slides open again. The 'door' object state changes to 'open'."
        }
      ],
      "exit_condition": "You walk through the open door, finding the chalice waiting for you on the corridor floor."
    },
    {
      "id": 4,
      "name": "The Alchemist's Basin",
      "difficulty_score": 4,
      "setting_description": "A circular room. In the center is a large basin filled with clear water. Around the room are three taps labeled: 'Blood', 'Bile', and 'Tears'. A riddle is carved into the basin rim: 'To see the path, the water must mimic the sunset.'",
      "interactables": [
        {
          "target": "taps",
          "description": "Blood (Red liquid), Bile (Yellow liquid), Tears (Clear/Blue liquid).",
          "interactions": [
            "`look taps`: Three brass taps, labeled 'Blood', 'Bile', and 'Tears'.",
            "`turn blood` or `use blood tap`: Red liquid pours into the basin, tinting the water.",
            "`turn bile` or `use bile tap`: Yellow liquid pours into the basin, tinting the water.",
            "`turn tears` or `use tears tap`: Clear blue liquid pours into the basin, tinting the water.",
            "**Note:** Each use changes the `current_color` and `is_boiling` state of the basin."
          ]
        },
        {
          "target": "basin",
          "description": "Currently filled with clear water. At the bottom, under the water, you see a key, but the water is boiling hotâ€”you cannot reach in. A small brass drain plug is visible at the base of the basin.",
          "states": [
            {
              "state": "default",
              "properties": {
                "water_level": "full",
                "current_color": "clear",
                "is_boiling": true
              },
              "interactions": [
                "`look basin`: You see a key at the bottom of the boiling, clear water.",
                "`take key`: The boiling water scalds your hand! You cannot.",
                "`look at water`: The water is clear and bubbling violently.",
                "`pull plug` or `drain basin`: You pull the small plug. The basin empties with a gurgle, then immediately refills with cool, clear water from a hidden source. The key remains at the bottom. Resets color to clear and boiling to true."
              ]
            },
            {
              "state": "colored",
              "properties": {
                "water_level": "full",
                "current_color": "varies (red, yellow, blue, green, orange, purple, brown)",
                "is_boiling": true
              },
              "interactions": [
                "`look basin`: You see a key at the bottom of the boiling, [current_color] water.",
                "`look at water`: The water is [current_color] and bubbling.",
                "`take key`: The boiling water scalds your hand! You cannot.",
                "`pull plug`: Drains and resets the puzzle."
              ]
            },
            {
              "state": "orange_and_cool",
              "properties": {
                "water_level": "full",
                "current_color": "orange",
                "is_boiling": false
              },
              "interactions": [
                "`look basin`: You see a key at the bottom of the calm, orange-tinted water. Steam no longer rises.",
                "`look at water`: The water is a perfect sunset orange and is now cool to the touch.",
                "`take key`: You reach in and retrieve the Iron Key. (Triggers Automatic Event: Key Taken)."
              ]
            }
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "iron_key",
          "name": "Iron Key",
          "location_description": "Submerged in the boiling basin.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look key`: A simple iron key.",
                "`use key`: Must be used on the far door."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Cool the water or drain it? No, the riddle implies color mixing.",
        "solution_steps": [
          "Riddle: 'Sunset' implies Orange.",
          "Player must interact with taps to mix colors into the basin.",
          "Player must turn on 'Blood' (Red) and 'Bile' (Yellow) taps. Accept commands like 'turn blood', 'turn bile', 'turn red', 'turn yellow', 'use blood tap', 'use bile tap', etc.",
          "Red + Yellow = Orange. When the water turns Orange, the boiling stops.",
          "Player can now 'take key' from the basin.",
          "Recovery: If the player adds the wrong color (e.g., Tears/Blue), they must examine the basin which will describe the current water color. The water can be drained by pulling a small drain plug at the base of the basin, resetting the puzzle. Command: 'pull plug' or 'drain basin'. The basin refills with clear water automatically after draining."
        ],
        "failure_response": "The water is still boiling furiously. Looking at the basin reveals the water is now [current color]. Perhaps you need to start fresh?"
      },
      "automatic_events": [
        {
          "trigger": "The water in the basin becomes orange (via tap combination).",
          "action": "The boiling ceases. The basin's `is_boiling` property changes to false and its state changes to 'orange_and_cool'."
        },
        {
          "trigger": "Player takes the Iron Key from the cool, orange water.",
          "action": "The key is added to inventory. The basin description updates to note the key is gone."
        },
        {
          "trigger": "Player pulls the drain plug.",
          "action": "The basin empties and refills instantly with cool, clear, boiling water. Resets all color mixing progress. The basin state returns to 'default'."
        }
      ],
      "exit_condition": "You unlock the far door with the Iron Key."
    },
    {
      "id": 5,
      "name": "The Library of Silence",
      "difficulty_score": 5,
      "setting_description": "A dusty library. There are 7 bookshelves labeled A through G. In the center is a reading desk with a single book glued to it, open to page 4. A translucent, ghostly librarian floats near the exit, wailing loudly and blocking the path. A pile of unsorted, dusty books sits on a cart in the corner.",
      "interactables": [
        {
          "target": "ghost",
          "description": "The librarian shrieks in agony. She seems distressed by the disorder of the library.",
          "states": [
            {
              "state": "distressed",
              "interactions": [
                "`look ghost`: A translucent figure wringing her hands, her wails are deafening. She blocks the exit.",
                "`talk to ghost`: Your words are drowned out by her shrieking.",
                "`give hymnal to ghost`: She ignores the book, gesturing frantically at the shelves."
              ]
            },
            {
              "state": "pacified",
              "interactions": [
                "`look ghost`: The librarian gives you a serene smile and a silent bow before fading away. The exit is clear."
              ]
            }
          ]
        },
        {
          "target": "bookshelves",
          "description": "Seven shelves. Shelf D has a noticeable gap where a book is missing.",
          "states": [
            {
              "state": "missing book",
              "interactions": [
                "`look shelves`: Shelves A through G. Shelf D has an obvious empty spot.",
                "`look at shelf d`: The label reads 'D'. The empty spot is labeled '4 - The Blue Hymnal'.",
                "`place blue hymnal on shelf d`: You slot the book into place. It fits perfectly. (Triggers Automatic Event: Ghost Pacified)"
              ]
            },
            {
              "state": "complete",
              "interactions": [
                "`look shelves`: All shelves are neatly ordered."
              ]
            }
          ]
        },
        {
          "target": "open book",
          "description": "The text on the desk is a catalog. It highlights a specific entry: 'The Blue Hymnal - Shelf D, Position 4'. Someone has scrawled 'Returned to cart' next to the entry.",
          "interactions": [
            "`look book` or `read book`: You read the catalog entry for 'The Blue Hymnal - Shelf D, Position 4'. A note says 'Returned to cart'.",
            "`take book`: It is firmly glued to the desk."
          ]
        },
        {
          "target": "cart",
          "description": "A wooden cart filled with unsorted books covered in cobwebs.",
          "interactions": [
            "`look cart`: A messy pile of old books.",
            "`search cart`: You rummage through the dusty tomes and find a book with a blue cover: The Blue Hymnal. (Adds 'blue_hymnal' to available items if not already taken)."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "blue_hymnal",
          "name": "Blue Hymnal",
          "location_description": "Buried at the bottom of the book cart.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look hymnal`: A thick book with a faded blue leather cover.",
                "`place hymnal` or `use hymnal`: You must specify a target (e.g., 'place hymnal on shelf d')."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Quiet the ghost by organizing the library.",
        "solution_steps": [
          "1. Player looks at 'open book' to learn the missing book is the 'Blue Hymnal' and was left on the 'cart'.",
          "2. Player must 'search cart' or 'look in cart' to find the specific item.",
          "3. Player obtains 'Blue Hymnal'.",
          "4. Player must 'place Blue Hymnal' on 'Shelf D'.",
          "5. Completing the shelf satisfies the librarian's obsessive need for order."
        ],
        "failure_response": "The ghost shrieks louder, pushing you back with a wave of cold air."
      },
      "automatic_events": [
        {
          "trigger": "Player successfully places the Blue Hymnal on Shelf D.",
          "action": "The ghost's wailing ceases immediately. The 'ghost' object state changes to 'pacified'. The 'bookshelves' object state for Shelf D changes to 'complete'. The ghost fades away after a moment."
        }
      ],
      "exit_condition": "The ghost sighs in relief, bows to you, and fades away, unblocking the exit."
    },
    {
      "id": 6,
      "name": "The Clockwork Wall",
      "difficulty_score": 6,
      "setting_description": "A massive mechanical wall blocks your path. On the wall are three axels: Left, Center, and Right. The Left axel is spinning rapidly, powered by steam. The Right axel is connected to the door mechanism but is stationary. The Center axel is free-spinning. To the side is a grease-covered workbench.",
      "interactables": [
        {
          "target": "axels",
          "description": "Left (Powered, spinning Clockwise), Center (Empty), Right (Door Mechanism, requires Counter-Clockwise rotation).",
          "states": [
            {
              "state": "initial",
              "interactions": [
                "`look axels`: Left: spinning CW. Center: empty, free. Right: stationary, connected to door.",
                "`place rusty gear on left axel`: The gear clunks onto the spinning axel and meshes. It now spins Clockwise.",
                "`place brass gear on center axel`: The gear is placed on the free-spinning axel.",
                "`place gear on right axel`: The gear is placed, but without power, it does nothing."
              ]
            },
            {
              "state": "gears_meshed",
              "description": "Rusty Gear on Left, Brass Gear on Center, gears meshed.",
              "interactions": [
                "`look axels`: Left gear (CW) is turning the Center gear (CCW). The Right axel is still stationary.",
                "`use drive belt on center axel`: You attach one end of the belt to the Center axel.",
                "`use drive belt on right axel`: You attach the other end to the Right axel, connecting them."
              ]
            },
            {
              "state": "belt_connected",
              "description": "Center (CCW) connected to Right via belt.",
              "interactions": [
                "`look axels`: The Center axel turns Counter-Clockwise, driving the Right axel via the belt. The Right axel begins turning Counter-Clockwise. (Triggers Automatic Event: Door Opens after a short description of the mechanism engaging)."
              ]
            }
          ]
        },
        {
          "target": "diagram",
          "description": "A faded blueprint on the wall shows: 'Even gears reverse direction. Odd gears maintain direction.'",
          "interactions": [
            "`look diagram`: The text is clear. A simple diagram shows two gears meshing, with arrows indicating a direction reversal."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "rusty_gear",
          "name": "Rusty Gear",
          "location_description": "On the workbench.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look gear`: A large, heavy iron gear with an odd number of teeth (Odd Gear).",
                "`use gear` or `place gear`: Must specify an axel (left, center, right)."
              ]
            }
          ]
        },
        {
          "item_id": "brass_gear",
          "name": "Brass Gear",
          "location_description": "On the workbench.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look gear`: A shiny brass gear with an even number of teeth (Even Gear).",
                "`use gear` or `place gear`: Must specify an axel (left, center, right)."
              ]
            }
          ]
        },
        {
          "item_id": "drive_belt",
          "name": "Leather Drive Belt",
          "location_description": "Hanging on a hook above the bench.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look belt`: A long, sturdy leather belt.",
                "`use belt`: Must specify two axels to connect (e.g., 'use belt on center axel', then 'use belt on right axel')."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Connect the powered axel to the door axel with the correct rotation.",
        "solution_steps": [
          "Logic: The Left axel is spinning Clockwise. The Door needs Counter-Clockwise torque to open.",
          "If the player connects Left -> Right directly with the Belt, the Right spins Clockwise (Wrong direction, door jams).",
          "If the player meshes gears directly, they reverse direction.",
          "Correct Solution:",
          "1. Place 'Rusty Gear' on Left Axel.",
          "2. Place 'Brass Gear' on Center Axel.",
          "3. The gears mesh. Left (CW) turns Center (CCW).",
          "4. Now connect Center Axel to Right Axel using the 'Leather Drive Belt'.",
          "5. Since belts maintain rotation, Center (CCW) turns Right (CCW). The door opens."
        ],
        "failure_response": "The mechanism grinds horribly and jams. The rotation is wrong."
      },
      "automatic_events": [
        {
          "trigger": "Player correctly connects the Center (CCW) and Right axels with the drive belt.",
          "action": "The Right axel begins spinning Counter-Clockwise. A series of loud clunks echoes through the wall, and it begins to lift. The 'axels' state changes to 'belt_connected' and the exit is cleared."
        },
        {
          "trigger": "Player connects two axels with incorrect rotation (e.g., Left directly to Right with a belt).",
          "action": "A horrible grinding sound erupts. The mechanism jams and smoke pours out. The puzzle must be reset by removing all gears and the belt."
        }
      ],
      "exit_condition": "The heavy gears click into place, the Right axel spins Counter-Clockwise, and the wall lifts."
    },
    {
      "id": 7,
      "name": "The Shadow Dial",
      "difficulty_score": 6,
      "setting_description": "A domed room with a skylight. A beam of light hits a sundial in the center. The sundial has no numbers, only symbols: A Skull, A Sword, A Crown, A Rose. There are four buttons on the wall corresponding to the symbols. The light is currently hitting the 'Rose'.",
      "interactables": [
        {
          "target": "sundial",
          "description": "You can rotate the sundial. Rotating it changes which symbol is in the light.",
          "interactions": [
            "`look sundial`: A stone dial with four symbols. The beam of light illuminates the [current_symbol].",
            "`rotate sundial`: You turn the dial. The light now falls on the [next_symbol in sequence].",
            "`rotate sundial to [symbol]`: You carefully align the [symbol] with the light."
          ]
        },
        {
          "target": "buttons",
          "description": "Pressing a button resets the trap mechanism.",
          "interactions": [
            "`look buttons`: Four stone buttons, each carved with a symbol: Rose, Sword, Crown, Skull.",
            "`press rose button`: The button depresses with a click.",
            "`press sword button`: The button depresses with a click.",
            "`press crown button`: The button depresses with a click.",
            "`press skull button`: The button depresses with a click.",
            "**Note:** Pressing a button when the sundial is *not* on the corresponding symbol, or pressing them out of order, triggers the trap (failure_response)."
          ]
        },
        {
          "target": "wall text",
          "description": "Text reads: 'Life begins, War follows, The King rules, Death takes all.'",
          "interactions": [
            "`read text` or `look at wall text`: The riddle is clear: Life begins, War follows, The King rules, Death takes all."
          ]
        }
      ],
      "items_available": [],
      "puzzle_logic": {
        "goal": "Enter the code in the correct order while manipulating the light.",
        "solution_steps": [
          "The riddle defines the order: Life (Rose) -> War (Sword) -> King (Crown) -> Death (Skull).",
          "The player must Rotate Sundial to Rose -> Press Rose Button.",
          "Rotate Sundial to Sword -> Press Sword Button.",
          "Rotate Sundial to Crown -> Press Crown Button.",
          "Rotate Sundial to Skull -> Press Skull Button."
        ],
        "failure_response": "Spikes shoot out of the wall and retract. That was the wrong order or the dial wasn't aligned."
      },
      "automatic_events": [
        {
          "trigger": "Player presses any button while the sundial light is *not* on the corresponding symbol.",
          "action": "Immediate trap trigger: spikes shoot from the walls, harming the player. The button sequence resets."
        },
        {
          "trigger": "Player presses the buttons in the incorrect order (even if the sundial is aligned correctly for that button).",
          "action": "Immediate trap trigger on the out-of-order press. The sequence resets."
        },
        {
          "trigger": "Player successfully presses the Skull button as the fourth and final correct action.",
          "action": "A hidden door in the wall behind the sundial grinds open. The exit is revealed."
        }
      ],
      "exit_condition": "A secret passage opens behind the sundial."
    },
    {
      "id": 8,
      "name": "The Mirror of Truth",
      "difficulty_score": 7,
      "setting_description": "A symmetrical room with two identical doors: Left and Right. Both have keyholes, but no handles. In the center is a large, magical mirror. Your reflection shows you holding a Silver Key in your right hand, but your hands are currently empty. The reflection is pointing imperiously at the Right Door.",
      "interactables": [
        {
          "target": "doors",
          "description": "Both are locked. You cannot pick these locks.",
          "states": [
            {
              "state": "locked",
              "interactions": [
                "`look left door`: A plain door with a keyhole.",
                "`look right door`: A plain door with a keyhole.",
                "`unlock left door with silver key`: The key fits, but won't turn. The reflection in the mirror shakes its head, pointing at the Right Door.",
                "`unlock right door with silver key`: The key fits. As you turn it, your reflection does the same. The lock clicks open. (Triggers Automatic Event: Right Door Unlocks)."
              ]
            },
            {
              "state": "unlocked",
              "interactions": [
                "`look right door`: It is now unlocked. You can open it."
              ]
            }
          ]
        },
        {
          "target": "mirror",
          "description": "The reflection refuses to mimic your movements until you match its appearance. It holds a Silver Key.",
          "states": [
            {
              "state": "out_of_sync",
              "interactions": [
                "`look mirror`: Your reflection holds a Silver Key and points at the Right Door. It does not mimic your movements.",
                "`wave`: Your reflection does not wave back.",
                "`show key`: You have no key to show."
              ]
            },
            {
              "state": "in_sync",
              "interactions": [
                "`look mirror`: Your reflection now mimics your every move perfectly, including the Silver Key in its hand.",
                "`wave`: Your reflection waves back.",
                "`unlock right door`: Your reflection performs the same action in the mirror world."
              ]
            }
          ]
        },
        {
          "target": "chandelier",
          "description": "A crystal chandelier hangs above. Amidst the crystals, something glints silver.",
          "interactions": [
            "`look chandelier`: A dusty crystal chandelier. A silver key is caught amongst the central crystals.",
            "`take key`: It's too high up.",
            "`jump`: You can't reach.",
            "`shake chandelier` or `hit chandelier`: You jostle the fixture. The Silver Key clatters to the floor. (Adds 'silver_key' to available items)."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "silver_key",
          "name": "Silver Key",
          "location_description": "Hidden in the chandelier (requires 'look at chandelier' to spot).",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look key`: An ornate silver key.",
                "`use key`: Must specify a door.",
                "**Automatic Effect:** Simply having this key in inventory changes the 'mirror' state to 'in_sync'."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Sync with the reflection to unlock the door.",
        "solution_steps": [
          "1. Inspecting the doors reveals they are impassable.",
          "2. Player must 'look at chandelier' and discover the key.",
          "3. Player must 'take key' (possibly needing to knock it down or jump).",
          "4. Once the player holds the Silver Key, the reflection mimics the player perfectly.",
          "5. The player must now 'unlock Right Door'. Because the reflection is doing the same action in the 'mirror world', the magic allows the key to turn.",
          "6. If the player tries to unlock the Left Door, the key simply won't turn, as the reflection (the source of the magic) is pointing to the Right."
        ],
        "failure_response": "You turn the key, but the lock doesn't catch. The reflection shakes its head, pointing firmly at the other door."
      },
      "automatic_events": [
        {
          "trigger": "Player acquires the Silver Key (picks it up from the floor).",
          "action": "The mirror's reflection immediately changes to mimic the player. The 'mirror' object state changes from 'out_of_sync' to 'in_sync'."
        },
        {
          "trigger": "Player successfully uses the Silver Key on the Right Door while the mirror is in sync.",
          "action": "The lock clicks audibly. The 'right door' object state changes to 'unlocked'."
        }
      ],
      "exit_condition": "The Right Door clicks unlocked and swings open."
    },
    {
      "id": 9,
      "name": "The Elemental Gauntlet",
      "difficulty_score": 8,
      "setting_description": "The final barrier. A massive door has three intricate locks. In the room are three pedestals: One frozen in a block of ice, one burning with magical fire, and one encased in a hard clay rock. A pipe in the corner leaks water into a small drain. Near the pipe lies a bucket and a hammer.",
      "interactables": [
        {
          "target": "ice pedestal",
          "description": "A key is frozen inside the ice block.",
          "states": [
            {
              "state": "frozen",
              "interactions": [
                "`look ice pedestal`: A clear block of ice with a glimmering key inside.",
                "`take key`: The ice is too thick.",
                "`pour embers on ice pedestal`: The hot coals sizzle and melt the ice rapidly. The ice block melts away. (State changes to 'melted')."
              ]
            },
            {
              "state": "melted",
              "interactions": [
                "`look ice pedestal`: A puddle of water surrounds the now-accessible Ice Key.",
                "`take key`: You take the Ice Key. (Adds to inventory)."
              ]
            }
          ]
        },
        {
          "target": "fire pedestal",
          "description": "A key is glowing red hot in the magical flames. Once extinguished, the remaining coals still smoke slightly...",
          "states": [
            {
              "state": "burning",
              "interactions": [
                "`look fire pedestal`: Magical flames dance around a red-hot key.",
                "`take key`: The heat is unbearable.",
                "`pour water on fire pedestal`: The water hits the flames with a great hiss of steam. The fire is extinguished, leaving behind smoldering coals and a cooling key. (State changes to 'extinguished')."
              ]
            },
            {
              "state": "extinguished",
              "interactions": [
                "`look fire pedestal`: Smoldering coals and a warm, now-safe key.",
                "`take key`: You take the Fire Key. (Adds to inventory).",
                "`scoop embers`: Using the empty bucket, you gather some of the hot coals. (Changes bucket state to 'contains_embers')."
              ]
            }
          ]
        },
        {
          "target": "clay pedestal",
          "description": "A key is sealed inside a hard clay shell.",
          "states": [
            {
              "state": "intact",
              "interactions": [
                "`look clay pedestal`: A rough, baked clay shell encases a key.",
                "`take key`: The shell is too hard to break by hand.",
                "`use hammer on clay pedestal`: You smash the clay shell to pieces. (State changes to 'shattered')."
              ]
            },
            {
              "state": "shattered",
              "interactions": [
                "`look clay pedestal`: Fragments of clay surround the Clay Key.",
                "`take key`: You take the Clay Key. (Adds to inventory)."
              ]
            }
          ]
        },
        {
          "target": "pipe",
          "description": "A steady stream of water trickles from a crack in the wall. A bucket rests next to it.",
          "interactions": [
            "`look pipe`: Water drips from a crack.",
            "`use bucket on pipe`: You hold the bucket under the drip, filling it with water. (Changes bucket state to 'contains_water')."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "hammer",
          "name": "Heavy Hammer",
          "location_description": "Propped against the wall.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look hammer`: A sturdy stone hammer.",
                "`use hammer`: Must specify a target (e.g., 'use hammer on clay pedestal')."
              ]
            }
          ]
        },
        {
          "item_id": "bucket",
          "name": "Wooden Bucket",
          "location_description": "Sitting near the drain.",
          "states": [
            {
              "state": "empty",
              "interactions": [
                "`look bucket`: An empty wooden bucket.",
                "`use bucket`: Must specify a target (e.g., 'use bucket on pipe')."
              ]
            },
            {
              "state": "contains_water",
              "interactions": [
                "`look bucket`: A bucket full of water.",
                "`pour water`: Must specify a target (e.g., 'pour water on fire pedestal'). This empties the bucket."
              ]
            },
            {
              "state": "contains_embers",
              "interactions": [
                "`look bucket`: A bucket holding hot, smoldering coals.",
                "`pour embers`: Must specify a target (e.g., 'pour embers on ice pedestal'). This empties the bucket."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Retrieve 3 keys using environment and inventory interactions.",
        "solution_steps": [
          "The player must `look around` to find the items and collect them",
          "1. Stone Key: Player must 'use hammer' on 'clay pedestal' to smash the shell. (Acquire Clay Key).",
          "2. Fire Key: Player must 'take bucket'. Player must 'use bucket' on 'pipe' to fill it with water. Player 'pour water' on 'fire pedestal'. The flames die and the key cools. (Acquire Fire Key).",
          "3. Ice Key: The bucket is now empty. The player must use the bucket to scoop 'hot coals' or 'embers' from the now-extinguished fire pedestal. Player 'pour embers' on 'ice pedestal'. The heat melts the ice. (Acquire Ice Key).",
          "4. Player uses all three keys on the final door."
        ],
        "failure_response": "You cannot retrieve that key without hurting yourself or destroying it."
      },
      "automatic_events": [
        {
          "trigger": "Player uses hammer on clay pedestal.",
          "action": "The clay shell shatters. The 'clay pedestal' state changes to 'shattered'."
        },
        {
          "trigger": "Player pours water from the bucket onto the fire pedestal.",
          "action": "The magical flames are extinguished. The 'fire pedestal' state changes to 'extinguished'. The bucket's state changes to 'empty'."
        },
        {
          "trigger": "Player uses the empty bucket on the extinguished fire pedestal (to scoop embers).",
          "action": "The bucket is filled with hot coals. The bucket's state changes to 'contains_embers'."
        },
        {
          "trigger": "Player pours embers from the bucket onto the ice pedestal.",
          "action": "The ice block melts. The 'ice pedestal' state changes to 'melted'. The bucket's state changes to 'empty'."
        }
      ],
      "exit_condition": "The three locks tumble in unison. The door to the Silver King opens."
    },
    {
      "id": 10,
      "name": "BOSS: The Silver King Construct",
      "difficulty_score": 10,
      "setting_description": "The Silver King is a giant animated suit of armor towering over you. He stands on a central metal grate. In the four corners of the room are Tesla Coils humming with lethal electricity. A large red Tool Chest sits open against the south wall. Next to the chest are four heavy Rubber Mats on the floor.",
      "interactables": [
        {
          "target": "Silver King",
          "description": "He is charging a massive lightning attack. Physical attacks bounce off him.",
          "states": [
            {
              "state": "charging (Turn 1)",
              "interactions": [
                "`look king`: The giant armor crackles with energy. 'CHARGE!' booms a metallic voice.",
                "`attack king`: Your weapon strikes harmless sparks from his plating."
              ]
            },
            {
              "state": "aiming (Turn 2)",
              "interactions": [
                "`look king`: He raises his arm, a ball of lightning forming. 'AIM!'",
                "`attack king`: Your attack is ignored."
              ]
            },
            {
              "state": "vulnerable (Post-discharge)",
              "interactions": [
                "`look king`: The armor is dark, sparking, and motionless. He has been destroyed from within."
              ]
            }
          ]
        },
        {
          "target": "Tesla Coils",
          "description": "They are gathering energy to shield the King. They have connection ports at the base.",
          "interactions": [
            "`look coils`: Four towers humming with electricity. They have open connection ports at their bases.",
            "`use copper cable on coils`: You connect the loose end of the cable to the port on the nearest coil. The cable now leads from the coils to the metal grate. (Only works if cable's other end is already attached to the grate)."
          ]
        },
        {
          "target": "metal grate",
          "description": "The floor section the King stands on.",
          "interactions": [
            "`look grate`: A large metal grate making up the center of the floor.",
            "`use copper cable on grate`: You secure one end of the copper cable to the grate. The other end is free."
          ]
        },
        {
          "target": "Tool Chest",
          "description": "It contains heavy-duty construction supplies.",
          "interactions": [
            "`look chest`: An open chest containing tools. A spool of copper cable is inside.",
            "`take cable`: You take the spool of Copper Cable."
          ]
        },
        {
          "target": "Rubber Mats",
          "description": "Thick industrial mats, clearly non-conductive.",
          "interactions": [
            "`look mats`: Four heavy rubber mats.",
            "`take mat`: You lift one. It's heavy.",
            "`stand on mat` or `use mat`: You move to stand on the rubber mat. You are now insulated from the floor."
          ]
        }
      ],
      "items_available": [
        {
          "item_id": "copper_cable",
          "name": "Spool of Copper Cable",
          "location_description": "Inside the Tool Chest.",
          "states": [
            {
              "state": "in inventory",
              "interactions": [
                "`look cable`: A long spool of thick copper wire.",
                "`use cable`: Must specify two targets to create a circuit: first the 'metal grate', then a 'tesla coil'."
              ]
            }
          ]
        }
      ],
      "puzzle_logic": {
        "goal": "Ground the boss's electricity to destroy him.",
        "solution_steps": [
          "This is a timed puzzle. The Boss describes 'Charging' (Turn 1), 'Aiming' (Turn 2), 'Firing' (Turn 3).",
          "1. Turn 1: Player must 'take copper cable' from the chest.",
          "2. Turn 1 or 2: Player must 'use copper cable' on 'metal grate', then 'use copper cable' on 'Tesla Coils'. This connects the coils to the metal grate the boss is standing on.",
          "3. Turn 2 or 3 (Crucial): The floor is now about to become electrified. The player must 'stand on rubber mat' or 'use rubber mat'.",
          "4. When the Boss fires, the electricity travels through the coils, down the wire, into the metal grate, and fries the Boss (who is standing on the grate). The player is safe on the mat."
        ],
        "failure_response": "The lightning discharges. If you didn't wire the coils, the Boss is shielded. If you didn't stand on the mat, you are electrocuted."
      },
      "automatic_events": [
        {
          "trigger": "Start of combat.",
          "action": "A narrative countdown begins: 'The Silver King booms: CHARGE!' (Turn 1)."
        },
        {
          "trigger": "End of Player's Turn 1.",
          "action": "Narrative: 'The King raises his arm. AIM!' (Turn 2)."
        },
        {
          "trigger": "End of Player's Turn 2.",
          "action": "Narrative: 'LIGHTNING STRIKE!' (Turn 3). The automatic resolution occurs based on player setup."
        },
        {
          "trigger": "Turn 3 with correct setup (cable connecting grate to coils, player on mat).",
          "action": "The lightning arcs from the King, into the coils, down the cable, and grounds through the grate he's standing on. The King overloads and explodes."
        },
        {
          "trigger": "Turn 3 with incorrect setup (missing cable or player not on mat).",
          "action": "The lightning strikes the player or the shielded King, resulting in failure (player death or combat reset)."
        }
      ],
      "exit_condition": "The Silver King overloads. The armor blasts apart, leaving behind the Treasure of the Realm."
    }
  ]
}
